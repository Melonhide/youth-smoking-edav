[["index.html", "Youth Smoking Chapter 1 Introduction", " Youth Smoking Jonathan Huynh, Tengteng Tao, Jinyu Wang 2021-12-12 Chapter 1 Introduction "],["data-sources.html", "Chapter 2 Data sources", " Chapter 2 Data sources "],["data-transformation.html", "Chapter 3 Data transformation 3.1 Preprocessing", " Chapter 3 Data transformation 3.1 Preprocessing The original datasets are in separate spreadsheets from Historical NYTS Data and Documentation. We selected some same questions across the years and create a new spreadsheet in long format where columns are Years and selected questions. Since the datasets are large, we only select 5 years to compare (2016-2020). The codebook are shown below. Year How old are you? What is your sex? What grade are you in? No, not of Hispanic, Latino, Latina or Spanish origin: Are you Hispanic, Latino, Latina, or of Spanish origin? (Select one or more) Yes, Mexican, Mexican American, Chicano, or Chicana: Are you Hispanic, Latino, Latina, or of Spanish origin? (Select one or more) Yes, Puerto Rican: Are you Hispanic, Latino, Latina, or of Spanish origin? (Select one or more) Yes, Cuban: Are you Hispanic, Latino, Latina, or of Spanish origin? (Select one or more) Yes, Another Hispanic, Latino, Latina, or Spanish origin: Are you Hispanic, Latino, Latina, or of Spanish origin? (Select one or more) American Indian or Alaska Native: What race or races do you consider yourself to be? (Select one or more) Asian: What race or races do you consider yourself to be? (Select one or more) Black or African American: What race or races do you consider yourself to be? (Select one or more) Native Hawaiian or Other Pacific Islander: What race or races do you consider yourself to be? (Select one or more) White: What race or races do you consider yourself to be? (Select one or more) Have you ever smoked a cigarette, even one or two puffs? How old were you when you first smoked a cigarette, even one or two puffs? About how many cigarettes have you smoked in your entire life? During the past 30 days, on how many days did you smoke cigarettes? When was the last time you smoked a cigeratte, even one or two puffs? (Please choose the first answer that fits) During the past 30 days, on the days you smoked, about how many cigarettes did you smoke per day? A pack usually has 20 cigarettes in it. During the past 30 days, what brand of cigarettes did you usually smoke? Menthol cigarettes are cigarettes that taste like mint. During the past 30 days, were the cigarettes that you usually smoked menthol? Have you ever been curious about smoking a cigarette? Do you think that you will try a cigarette soon? Do you think that you will smoke a cigarette in the next year? If one of your best friends were to offer you a cigarette, would you smoke it? Have you ever smoked a cigar, cigarillo, or little cigar, even one or two puffs? How old were you when you first smoked a cigar, cigarillo, or little cigar, even one or two puffs? Have you ever used chewing tobacco, snuff, or dip, even just a small amount? How old were you when you first used chewing tobacco, snuff, or dip, even just a small amount? Have you ever been curious about using an e-cigarette? Have you ever used an e-cigarette, even once or twice? 2020 QN1 QN2 QN3 QN4A QN4B QN4C QN4D QN4E QN5A QN5B QN5C QN5D QN5E QN22 QN23 QN24 QN25 QN26 QN27 QN29 QN30 QN31 QN32 QN33 QN34 QN35 QN36 QN44 QN45 QN17 QN6 2019 Q1 Q2 Q3 Q4A Q4B Q4C Q4D Q4E Q5A Q5B Q5C Q5D Q5E Q6 Q7 Q8 Q9 Q10 Q11 Q12 Q13 Q14 Q15 Q16 Q17 Q18 Q19 Q27 Q28 Q43 Q34 2018 Q1 Q2 Q3 Q4A Q4B Q4C Q4D Q4E Q5A Q5B Q5C Q5D Q5E Q7 Q8 Q9 Q11 Q10 Q12 Q13 Q14 Q6 Q15 Q16 Q17 Q19 Q20 Q24 Q25 Q27 Q28 2017 Q1 Q2 Q3 Q4A Q4B Q4C Q4D Q4E Q5A Q5B Q5C Q5D Q5E Q7 Q8 Q9 Q11 Q10 Q12 Q13 Q14 Q6 Q15 Q16 Q17 Q19 Q20 Q24 Q25 Q27 Q28 2016 Q1 Q2 Q3 Q4A Q4B Q4C Q4D Q4E Q5A Q5B Q5C Q5D Q5E Q7 Q11 Q12 Q13 Q15 Q14 Q16 Q17 Q6 Q8 Q9 Q10 Q18 Q19 Q22 Q23 Q25 Q26 To form our dataset, we simply append data frames from each year vertically. We also recode some missing responses to NAs to make the dataset consistent with important values and missings. The final spreadsheet looks something similar to below. Year How old are you? What is your sex? What grade are you in? No, not of Hispanic, Latino, Latina or Spanish origin: Are you Hispanic, Latino, Latina, or of Spanish origin? (Select one or more) Yes, Mexican, Mexican American, Chicano, or Chicana: Are you Hispanic, Latino, Latina, or of Spanish origin? (Select one or more) Yes, Puerto Rican: Are you Hispanic, Latino, Latina, or of Spanish origin? (Select one or more) Yes, Cuban: Are you Hispanic, Latino, Latina, or of Spanish origin? (Select one or more) Yes, Another Hispanic, Latino, Latina, or Spanish origin: Are you Hispanic, Latino, Latina, or of Spanish origin? (Select one or more) American Indian or Alaska Native: What race or races do you consider yourself to be? (Select one or more) Asian: What race or races do you consider yourself to be? (Select one or more) Black or African American: What race or races do you consider yourself to be? (Select one or more) Native Hawaiian or Other Pacific Islander: What race or races do you consider yourself to be? (Select one or more) White: What race or races do you consider yourself to be? (Select one or more) Have you ever smoked a cigarette, even one or two puffs? How old were you when you first smoked a cigarette, even one or two puffs? About how many cigarettes have you smoked in your entire life? During the past 30 days, on how many days did you smoke cigarettes? When was the last time you smoked a cigeratte, even one or two puffs? (Please choose the first answer that fits) During the past 30 days, on the days you smoked, about how many cigarettes did you smoke per day? A pack usually has 20 cigarettes in it. During the past 30 days, what brand of cigarettes did you usually smoke? Menthol cigarettes are cigarettes that taste like mint. During the past 30 days, were the cigarettes that you usually smoked menthol? Have you ever been curious about smoking a cigarette? Do you think that you will try a cigarette soon? Do you think that you will smoke a cigarette in the next year? If one of your best friends were to offer you a cigarette, would you smoke it? Have you ever smoked a cigar, cigarillo, or little cigar, even one or two puffs? How old were you when you first smoked a cigar, cigarillo, or little cigar, even one or two puffs? Have you ever used chewing tobacco, snuff, or dip, even just a small amount? How old were you when you first used chewing tobacco, snuff, or dip, even just a small amount? Have you ever been curious about using an e-cigarette? Have you ever used an e-cigarette, even once or twice? 2020 7 1 4 NA 1 NA NA NA 1 NA 1 NA NA 2 NA NA NA NA NA NA NA 4 3 3 3 2 NA 2 NA NA 1 2020 6 2 4 NA 1 NA NA NA NA NA NA NA 1 2 NA NA NA NA NA NA NA 4 4 4 4 2 NA 2 NA 3 2 2019 7 1 5 1 NA NA NA NA NA NA 1 NA NA 2 .S .S .S .S .S .S .S 4 4 4 4 2 .S 2 .S .S 1 2019 8 1 5 NA 1 NA NA 1 NA NA NA NA 1 2 .S .S .S .S .S .S .S 4 4 4 4 2 .S 2 .S .S 1 2018 07 1 4 1 NA NA NA NA NA NA 1 NA NA 2 01 1 1 1 1 01 3 4 3 3 4 NA NA NA NA NA NA 2018 07 2 4 1 NA NA NA NA NA NA 1 NA 1 2 01 1 1 1 1 01 1 1 4 4 3 2 01 2 01 3 2 2017 08 1 5 1 NA NA NA NA NA NA NA NA 1 1 06 8 1 6 1 01 1 1 4 4 4 1 08 1 06 1 1 2017 08 2 5 1 NA NA NA NA NA NA 1 NA 1 1 08 2 1 7 1 01 1 4 4 4 4 2 01 2 01 4 2 2016 04 1 2 1 NA NA NA NA NA NA 1 NA NA 2 01 1 1 1 1 01 1 2 3 4 3 2 01 2 01 2 2 2016 06 1 2 1 NA NA NA NA NA NA 1 NA 1 2 01 1 1 1 1 01 1 4 4 4 4 2 01 2 01 4 2 The preprocessing script is in resources/data_preprocessing.R. # Data Preprocessing ################################################################################ # The data we are using are surveys in very long spread sheets across multiple # years. The survey questions are not exactly the same in each year. We manually # mapped some important questions into another spread sheet. This code file is # to generate new data to use later. ################################################################################ library(tidyverse) library(readxl) years_to_use &lt;- list( &quot;2020&quot; = &quot;nyts2020.xlsx&quot;, &quot;2019&quot; = &quot;nyts2019.xlsx&quot;, &quot;2018&quot; = &quot;nyts2018.xlsx&quot;, &quot;2017&quot; = &quot;nyts2017.xlsx&quot;, &quot;2016&quot; = &quot;nyts2016.xlsx&quot; ) codebook &lt;- read_excel(&quot;data/nyts-codebook.xlsx&quot;) path &lt;- &quot;data/NYTS/&quot; years = c(&quot;2020&quot;, &quot;2019&quot;, &quot;2018&quot;, &quot;2017&quot;, &quot;2016&quot;) columns &lt;- colnames(codebook) final &lt;- data.frame(matrix(nrow=0, ncol=length(columns))) colnames(final) &lt;- columns missing &lt;- c(&quot;.&quot;, &quot;E&quot;, &quot;N&quot;, &quot;S&quot;, &quot;Z&quot;, &quot;.N&quot;, &quot;.S&quot;, &quot;.Z&quot;, &quot;*&quot;, &quot;**&quot;) for (y in years) { df &lt;- read_excel(paste0(path, years_to_use[[y]])) questions &lt;- codebook %&gt;% filter(Year == y) %&gt;% select(-Year) %&gt;% unlist(., use.names = FALSE) selected_df &lt;- df %&gt;% mutate(Year=y) %&gt;% select(Year, all_of(questions)) # recode some characters meaning missing responses to NA for (x in missing) { selected_df &lt;- selected_df %&gt;% mutate(across(everything(), na_if, x)) } colnames(selected_df) &lt;- columns final &lt;- rbind(final, selected_df) } write_excel_csv(final, &quot;data/nyts_grouped.csv&quot;) "],["missing-values.html", "Chapter 4 Missing values 4.1 Using Dataset From fivethirtyeight 4.2 California Tobacco Health Assessment Tool (https://cthat.org/).", " Chapter 4 Missing values 4.1 Using Dataset From fivethirtyeight Since we do not have any missing value in our data set, we analyze the data set avengers from the package fivethirtyeight. The above missing values plot was created from a data set created by Walk Hickey, an author at FiveThirtyEight. The data set was created to observe the mortality rate of different characters in the Marvel universe who signed on to the join the Avengers. According to this figure, we can clear see the missing value pattern of the data set. We can start with the complete cases: As we can see by the dark grey row with the complete cases label, there are 10 columns in the data that do not have any missing values. Compared to the missing values pattern, complete cases in this data set are very hard to see. However, for the missing value pattern, there is another story. We can see that the most common missing value pattern is having eleven missing variables. The eleven missing variables are: death4, return4, death5, return5, death3, return3, probationary_intro, return2, death2, return1 and notes. There are around 76 rows which have such a pattern in this data set. The second most common missing pattern is missing 9 variables. The nine variables are: death4, return4, death5, return5, death3, return3, probationary_intro, return2 and death2. In the whole data set of 173 rows, there are around 42 rows which have such a pattern. For the whole 21 variables in our data set, there are six variables that are the most common missing variables: death4, return4, death5, return5, death3, and return3. For each of those variables, there are around 160 rows, which is around 10% of the whole data set, missing them. The next three most common missing variables are probationary_Intro, return2, and death2. For each of those three variables, there are around 150 variables, which is around 10% of the whole data set, missing them. For the variable return1 and notes, there are around 100 rows, which is around 8% of the whole data set, missing them separately. For columns that do have missing values, just under 75% of them are only missing one or two values. For the whole 21 variables in our data set, we can see that death4, return4, death5, return5, death3, and return3 have the majority of their column values missing. In the context of the problem, it makes sense that if the death# value is missing, then the return# value is also missing because a character cannot return from being dead if they were not killed in the first place. Additionally, we should expect the death# value to be missing for larger numbers (i.e. 3, 4, 5) if the character has not returned from being killed after death1 or death2. The probationary_intro column also has a good amount of missing values and after a bit of research into the meaning of this column, we know that this column contains values for the data that a character was given probationary status as an Avenger. Since characters can be introduced as full or reserve Avengers without taking on the probationary status, we would expect this column to be missing values for characters who skipped the probationary period. As a result of this, we would also expect the full_reserve_avengers_intro column to contain values for characters who had a missing value for the probationary_intro column and also for characters who graduated from the probationary period and became a full or reserve Avenger. We can see from the plot that this holds true with the full_reserve_avengers_intro column colored as mostly light grey except for missing pattern 13 and 14 where probationary_intro is light grey and for missing pattern 4 where it is purple for both columns. death2 and return2 have many missing values, but less so than the greater number of deaths and resurrections which makes sense because it is pretty common for a character to die in the Marval universe. For the notes column, the missing values should correspond to characters who have not died since the value is a description of deaths and resurrections. The missing values in the name_alias column are actually a problem for this data set since this column is supposed to full name or alias of the character. Inspecting the data a bit further, it looks like the url values contain the name of the characters so we would be able to fill in these missing values if it was necessary to report statistics about specific characters for an analysis. 4.2 California Tobacco Health Assessment Tool (https://cthat.org/). Note: There are multiple sheets in this dataset (California, County, City, DesignatedPlace, Unincorporated, ZCTA) which have different ways of grouping for data in California. In this chapter we are looking at County level and City level. Besides the avengers data set, we also find another two data sets and plot the missing value patterns. For those two data sets, one thing needed to be claim is that those data sets have variables in two forms, the first form is named with variables names which is the count of values, the second form is named with number and stands for the percentage of the value in that variable column. Accordingly, for this condition, the two forms of data will both be missing values if either one of them is missing value. ## # A tibble: 6 x 39 ## GEOID NAME `TOTAL POPULATI~ `UNDER 5` ...5 `5 TO 17` ...7 `UNDER 21` ...9 ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 06001 Alam~ 1656754 96849 0.0585 247178 0.149 402545 0.243 ## 2 06003 Alpi~ 1039 44 0.0423 157 0.151 236 0.227 ## 3 06005 Amad~ 38429 1527 0.0397 4320 0.112 7007 0.182 ## 4 06007 Butt~ 225817 12384 0.0548 33055 0.146 58638 0.260 ## 5 06009 Cala~ 45514 1902 0.0418 5909 0.130 9012 0.198 ## 6 06011 Colu~ 21454 1576 0.0735 4266 0.199 6750 0.315 ## # ... with 30 more variables: WHITE &lt;dbl&gt;, ...11 &lt;dbl&gt;, BLACK &lt;dbl&gt;, ## # ...13 &lt;dbl&gt;, ASIAN AND PACIFIC ISLANDER &lt;chr&gt;, ...15 &lt;dbl&gt;, ## # HISPANIC / LATINO &lt;dbl&gt;, ...17 &lt;dbl&gt;, ALL OTHER RACES &lt;dbl&gt;, ...19 &lt;dbl&gt;, ## # HOUSEHOLD (NUMBER) &lt;dbl&gt;, HOUSEHOLDS RECEIVING SNAP BENEFITS &lt;dbl&gt;, ## # ...22 &lt;dbl&gt;, MEDIAN HOUSEHOLD INCOME &lt;dbl&gt;, SCHOOLS (NUMBER) &lt;dbl&gt;, ## # HIGH SCHOOLS (NUMBER) &lt;chr&gt;, ...26 &lt;dbl&gt;, ## # MIDDLE/JUNIOR HIGH SCHOOL (NUMBER) &lt;chr&gt;, ...28 &lt;dbl&gt;, ... For the county data set, we can clearly see that this data set only has three missing value patterns and the majority of the data comprised of complete rows of data (complete cases are the most common pattern). For the whole 58 rows data set, around 55 rows are complete cases. There are another three missing value patterns which all have similar probabilities. For those variables which may have missing values, the most common missing variables are RETAILER.WITHIN.500ft_NUMBER and SCHOOLS.WITHIN.500ft_NUMBER. For each of those two variables, in the total 58 rows data set, there are two rows missing them separately. The next several common missing variables are ASIAN.AND.PACIFIC.ISLANDER, HIGH.SCHOOL_NUMBER, SCHOOLS.WITH.A.RETAILER.WITHIN.1.000FT.NUMBER, and RETAILERS.WITH.A.SCHOOLWITHIN1.000FT.NUMBER. For each of those variables, there are one row missing them separately. ## # A tibble: 6 x 40 ## `PLACE GNIS COD~ GEOID NAME `TOTAL POPULATI~ `UNDER 5` ...6 `5 TO 17` ...8 ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 02409663 0600~ Adel~ 33660 2917 0.0867 8746 0.260 ## 2 02409666 0600~ Agou~ 20533 836 0.0407 3559 0.173 ## 3 02409669 0600~ Alam~ 78522 4689 0.0597 11267 0.143 ## 4 02409674 0600~ Alba~ 19804 1383 0.0698 3758 0.190 ## 5 02409681 0600~ Alha~ 84647 4093 0.0484 10239 0.121 ## 6 02409683 0600~ Alis~ 50663 3570 0.0705 8895 0.176 ## # ... with 32 more variables: UNDER 21 &lt;dbl&gt;, ...10 &lt;dbl&gt;, WHITE &lt;dbl&gt;, ## # ...12 &lt;dbl&gt;, BLACK &lt;chr&gt;, ...14 &lt;dbl&gt;, ASIAN AND PACIFIC ISLANDER &lt;chr&gt;, ## # ...16 &lt;dbl&gt;, HISPANIC / LATINO &lt;dbl&gt;, ...18 &lt;dbl&gt;, ALL OTHER RACES &lt;chr&gt;, ## # ...20 &lt;dbl&gt;, HOUSEHOLD (NUMBER) &lt;dbl&gt;, ## # HOUSEHOLDS RECEIVING SNAP BENEFITS &lt;chr&gt;, ...23 &lt;dbl&gt;, ## # MEDIAN HOUSEHOLD INCOME &lt;chr&gt;, SCHOOLS (NUMBER) &lt;chr&gt;, ## # HIGH SCHOOLS (NUMBER) &lt;chr&gt;, ...27 &lt;dbl&gt;, ... For the city data set, although the data set have a larger size than the previous data set, the majority of data is still comprised of complete rows of data (complete cases are the most common pattern). For the whole 483 rows, there are around 290 rows which have completely no missing values. For all other missing value patterns, the most common pattern is missing 4 variables, which are SCHOOL.WITH.A. RETAILER.WHITHIN. 500FT.NUMBER, RETAILERS.WITHIN.A. SCHOOL.WITHIN.500FT.NUMBER, SCHOOLS.WITH.A.RETAILER.WITHIN.1.000.NUMBER and RETAILER.WITH.ASCHOOL.WITHIN.1.000_NUMBER. There are around 40 rows that have this pattern in the data set, with 483 rows. Another widespread missing pattern is missing only one variable, HIGH.SCHOOL. NUMBER. There are around 25 rows that have this pattern in the whole 483 rows data set. For all the variables that existed in the data set, the two variables which are highly possible to have missing values are SCHOOL.WITH.A. RETAILER.WHITHIN. 500FT.NUMBER, and RETAILERS.WITHIN.A. SCHOOL.WITHIN.500FT.NUMBER. For each of them, there are 150 rows missing them separately. HIGH.SCHOOL. NUMBER., SCHOOLS.WITH.A.RETAILER.WITHIN.1.000.NUMBER and RETAILER.WITH.ASCHOOL.WITHIN.1.000_NUMBER are the next three most possible variables which may has missing values. For each of those variables, there are around 75 rows have missing values in them separately. "],["results.html", "Chapter 5 Results", " Chapter 5 Results "],["interactive-component.html", "Chapter 6 Interactive component", " Chapter 6 Interactive component "],["conclusion.html", "Chapter 7 Conclusion", " Chapter 7 Conclusion "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
